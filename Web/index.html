<!DOCTYPE html>
<html lang="en" class="light-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swift Architecture Diagram</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        :root {
    /* Modern Color Palette */
    --bg-color: #fafbfc;
    --text-color: #1e293b;
    --text-secondary: #64748b;
    --text-muted: #94a3b8;
    
    /* Brand Colors */
    --primary-color: #2563eb;
    --primary-light: #3b82f6;
    --primary-dark: #1d4ed8;
    --secondary-color: #64748b;
    --accent-color: #8b5cf6;
    
    /* State Colors */
    --success-color: #059669;
    --warning-color: #d97706;
    --error-color: #dc2626;
    --info-color: #0284c7;
    
    /* Surface Colors */
    --surface-bg: #ffffff;
    --surface-elevated: #ffffff;
    --border-color: #e2e8f0;
    --border-light: #f1f5f9;
    --divider-color: #e2e8f0;
    
    /* Component Backgrounds */
    --header-bg: rgba(255, 255, 255, 0.95);
    --sidebar-bg: rgba(248, 250, 252, 0.95);
    --card-bg: #ffffff;
    --input-bg: #ffffff;
    --button-bg: #ffffff;
    --button-hover: #f8fafc;
    --button-active: #f1f5f9;
    
    /* Diagram Specific */
    --diagram-bg-start: #f8fafc;
    --diagram-bg-end: #ffffff;
    --legend-bg: rgba(255, 255, 255, 0.98);
    
    /* Node Colors - Swift Types */
    --node-class: #dbeafe;
    --node-class-border: #2563eb;
    --node-struct: #fef3c7;
    --node-struct-border: #d97706;
    --node-protocol: #ede9fe;
    --node-protocol-border: #8b5cf6;
    --node-enum: #dcfce7;
    --node-enum-border: #059669;
    --node-actor: #fce7f3;
    --node-actor-border: #ec4899;
    --node-extension: #f0f9ff;
    --node-extension-border: #0284c7;
    
    /* Node States */
    --node-border: #94a3b8;
    --node-hover: #2563eb;
    --node-selected: #dc2626;
    --node-focused: #8b5cf6;
    
    /* Link Colors */
    --link-color: #94a3b8;
    --link-hover: #2563eb;
    --link-inheritance: #059669;
    --link-protocol: #8b5cf6;
    --link-dependency: #64748b;
    
    /* Access Level Colors */
    --access-public: #dcfce7;
    --access-internal: #fef3c7;
    --access-private: #fee2e2;
    --access-fileprivate: #fdf2f8;
    
    /* Type Explorer */
    --type-item-bg: transparent;
    --type-item-hover: #f8fafc;
    --type-item-selected: #eff6ff;
    --type-item-active: #dbeafe;
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    
    /* Border Radius */
    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 8px;
    --radius-xl: 12px;
    --radius-2xl: 16px;
    
    /* Transitions */
    --transition-fast: 150ms ease;
    --transition-normal: 250ms ease;
    --transition-slow: 350ms ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro Display', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: linear-gradient(135deg, var(--diagram-bg-start) 0%, var(--diagram-bg-end) 100%);
    color: var(--text-color);
    height: 100vh;
    overflow: hidden;
    transition: all var(--transition-normal);
    font-size: 14px;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.container {
    height: 100vh;
    display: flex;
    flex-direction: column;
    position: relative;
}

.header {
    padding: 1.25rem 2rem;
    border-bottom: 1px solid var(--border-color);
    background: var(--header-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    z-index: 1000;
    box-shadow: var(--shadow-sm);
    position: relative;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
    opacity: 0.3;
}

.header h1 {
    margin-bottom: 0.75rem;
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--primary-color);
    letter-spacing: -0.025em;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.header h1::before {
    content: '⚡';
    font-size: 1.5rem;
    display: inline-block;
}

.controls {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
    justify-content: space-between;
}

.control-group {
    display: flex;
    gap: 0.75rem;
    align-items: center;
}

.controls button {
    padding: 0.625rem 1.25rem;
    border: 1px solid var(--border-color);
    background: var(--button-bg);
    color: var(--text-color);
    cursor: pointer;
    border-radius: var(--radius-lg);
    font-size: 0.875rem;
    font-weight: 500;
    transition: all var(--transition-fast);
    box-shadow: var(--shadow-sm);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    white-space: nowrap;
}

.controls button:hover {
    background: var(--button-hover);
    border-color: var(--primary-color);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
    color: var(--primary-color);
}

.controls button:active {
    transform: translateY(0);
    box-shadow: var(--shadow-sm);
}

.controls button.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    box-shadow: var(--shadow-md);
}

.controls button.active:hover {
    background: var(--primary-dark);
    color: white;
}

.controls input[type="text"] {
    padding: 0.625rem 1rem;
    border: 1px solid var(--border-color);
    background: var(--input-bg);
    color: var(--text-color);
    border-radius: var(--radius-lg);
    font-size: 0.875rem;
    min-width: 240px;
    transition: all var(--transition-fast);
    box-shadow: var(--shadow-sm);
    position: relative;
}

.controls input[type="text"]:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1), var(--shadow-md);
    transform: translateY(-1px);
}

.controls input[type="text"]::placeholder {
    color: var(--text-muted);
    font-weight: 400;
}

.filter-group {
    display: flex;
    gap: 1.25rem;
    padding: 0.5rem 1rem;
    background: var(--surface-bg);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-sm);
    backdrop-filter: blur(10px);
}

.filter-group label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-secondary);
    transition: color var(--transition-fast);
    user-select: none;
}

.filter-group label:hover {
    color: var(--primary-color);
}

.filter-group input[type="checkbox"] {
    width: 18px;
    height: 18px;
    border: 2px solid var(--border-color);
    border-radius: var(--radius-sm);
    appearance: none;
    background: var(--surface-bg);
    cursor: pointer;
    transition: all var(--transition-fast);
    position: relative;
    margin: 0;
}

.filter-group input[type="checkbox"]:checked {
    background: var(--primary-color);
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
}

.filter-group input[type="checkbox"]:checked::after {
    content: '✓';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 12px;
    font-weight: 600;
}

.filter-group input[type="checkbox"]:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
}

.main-content {
    flex: 1;
    display: flex;
    overflow: hidden;
    position: relative;
}

.sidebar {
    width: 340px;
    min-width: 300px;
    max-width: 400px;
    padding: 1.5rem;
    border-right: 1px solid var(--border-color);
    background: var(--sidebar-bg);
    overflow-y: auto;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: var(--shadow-sm);
    transition: all var(--transition-normal);
    resize: horizontal;
    position: relative;
}

.sidebar::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 1px;
    height: 100%;
    background: linear-gradient(180deg, transparent, var(--primary-color), transparent);
    opacity: 0.2;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-light);
}

.sidebar h3 {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text-color);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
}

.sidebar h3::before {
    content: '📋';
    font-size: 1rem;
}

.sidebar-toggle {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    transition: all var(--transition-fast);
    font-size: 1.2rem;
}

.sidebar-toggle:hover {
    background: var(--button-hover);
    color: var(--primary-color);
}

.sidebar.collapsed {
    width: 60px;
    min-width: 60px;
    padding: 1rem 0.5rem;
}

.sidebar.collapsed .sidebar-header h3,
.sidebar.collapsed #type-list,
.sidebar.collapsed #type-details {
    display: none;
}

.sidebar.collapsed .sidebar-toggle {
    width: 100%;
    margin-bottom: 1rem;
}

.diagram-container {
    flex: 1;
    position: relative;
    background: linear-gradient(135deg, var(--diagram-bg-start), var(--diagram-bg-end));
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.diagram-search-bar {
    position: relative;
    padding: 1rem 2rem;
    background: var(--header-bg);
    border-bottom: 1px solid var(--border-color);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: var(--shadow-sm);
}

#diagram-search-input {
    width: 100%;
    padding: 1rem 1.25rem 1rem 3rem;
    border: 1px solid var(--border-color);
    background: var(--input-bg);
    color: var(--text-color);
    border-radius: var(--radius-xl);
    font-size: 1rem;
    font-weight: 400;
    transition: all var(--transition-fast);
    box-shadow: var(--shadow-sm);
    position: relative;
}

#diagram-search-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1), var(--shadow-md);
    transform: translateY(-1px);
}

#diagram-search-input::placeholder {
    color: var(--text-muted);
    font-weight: 400;
}

.diagram-search-bar::before {
    content: '🔍';
    position: absolute;
    left: 3rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.1rem;
    color: var(--text-muted);
    pointer-events: none;
    z-index: 10;
}

.search-results-overlay {
    position: absolute;
    top: calc(100% - 1px);
    left: 2rem;
    right: 2rem;
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-top: none;
    border-radius: 0 0 var(--radius-xl) var(--radius-xl);
    max-height: 400px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
    box-shadow: var(--shadow-xl);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
}

.search-results-overlay.active {
    display: block;
}

.search-result-item {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border-color);
    cursor: pointer;
    transition: background-color 0.2s ease;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.search-result-item:hover {
    background-color: var(--button-hover);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-type {
    font-weight: 600;
    color: var(--primary-color);
}

.search-result-kind {
    background-color: var(--primary-color);
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    text-transform: uppercase;
    font-weight: 500;
}

.search-result-description {
    color: var(--secondary-color);
    font-size: 0.875rem;
}

#diagram {
    width: 100%;
    flex: 1;
}

.floating-controls {
    position: absolute;
    top: 1rem;
    right: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    z-index: 100;
}

.floating-btn {
    width: 3rem;
    height: 3rem;
    border: none;
    background: var(--surface-bg);
    color: var(--text-color);
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    transition: all var(--transition-fast);
    box-shadow: var(--shadow-md);
    border: 1px solid var(--border-color);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.floating-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
    border-color: var(--primary-color);
}

.floating-btn:active {
    transform: translateY(0);
    box-shadow: var(--shadow-md);
}

.legend {
    position: absolute;
    bottom: 2rem;
    left: 2rem;
    background: var(--legend-bg);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-xl);
    padding: 1.25rem 1.5rem;
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    z-index: 1000;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: var(--shadow-lg);
    max-width: calc(100% - 4rem);
}

.legend::before {
    content: '📖 Type Legend';
    position: absolute;
    top: -0.75rem;
    left: 1rem;
    background: var(--legend-bg);
    padding: 0.25rem 0.75rem;
    border-radius: var(--radius-md);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-color);
    padding: 0.5rem 0.75rem;
    border-radius: var(--radius-lg);
    transition: all var(--transition-fast);
    cursor: pointer;
}

.legend-item:hover {
    background: var(--button-hover);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.legend-color {
    width: 20px;
    height: 20px;
    border-radius: var(--radius-md);
    border: 2px solid var(--surface-bg);
    box-shadow: var(--shadow-sm);
    position: relative;
}

.class-color { 
    background: var(--node-class); 
    border-color: var(--node-class-border);
}
.struct-color { 
    background: var(--node-struct);
    border-color: var(--node-struct-border);
}
.protocol-color { 
    background: var(--node-protocol);
    border-color: var(--node-protocol-border);
}
.enum-color { 
    background: var(--node-enum);
    border-color: var(--node-enum-border);
}
.actor-color { 
    background: var(--node-actor);
    border-color: var(--node-actor-border);
}

/* Dark Theme */
.dark-theme {
    --bg-color: #0f172a;
    --text-color: #e2e8f0;
    --text-secondary: #94a3b8;
    --text-muted: #64748b;
    
    --primary-color: #3b82f6;
    --primary-light: #60a5fa;
    --primary-dark: #2563eb;
    --secondary-color: #64748b;
    --accent-color: #a855f7;
    
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --error-color: #ef4444;
    --info-color: #06b6d4;
    
    --surface-bg: #1e293b;
    --surface-elevated: #334155;
    --border-color: #334155;
    --border-light: #475569;
    --divider-color: #334155;
    
    --header-bg: rgba(15, 23, 42, 0.95);
    --sidebar-bg: rgba(30, 41, 59, 0.95);
    --card-bg: #1e293b;
    --input-bg: #1e293b;
    --button-bg: #1e293b;
    --button-hover: #334155;
    --button-active: #475569;
    
    --diagram-bg-start: #0f172a;
    --diagram-bg-end: #1e293b;
    --legend-bg: rgba(30, 41, 59, 0.98);
    
    --node-class: #1e40af;
    --node-class-border: #3b82f6;
    --node-struct: #92400e;
    --node-struct-border: #f59e0b;
    --node-protocol: #7c2d12;
    --node-protocol-border: #a855f7;
    --node-enum: #065f46;
    --node-enum-border: #10b981;
    --node-actor: #831843;
    --node-actor-border: #ec4899;
    --node-extension: #0c4a6e;
    --node-extension-border: #06b6d4;
    
    --link-color: #64748b;
    --link-hover: #3b82f6;
    
    --type-item-hover: #334155;
    --type-item-selected: #1e40af;
    --type-item-active: #2563eb;
}

/* Responsive Design */
@media (max-width: 1024px) {
    .sidebar {
        width: 280px;
        min-width: 250px;
    }
    
    .controls {
        flex-wrap: wrap;
        gap: 0.75rem;
    }
    
    .filter-group {
        flex-wrap: wrap;
        gap: 1rem;
    }
    
    .legend {
        bottom: 1rem;
        left: 1rem;
        padding: 1rem;
        gap: 1rem;
    }
}

@media (max-width: 768px) {
    .header {
        padding: 1rem;
    }
    
    .header h1 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    .controls {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
    }
    
    .control-group {
        justify-content: center;
    }
    
    .sidebar {
        position: absolute;
        left: -320px;
        width: 320px;
        height: 100%;
        z-index: 1001;
        transition: left var(--transition-normal);
        box-shadow: var(--shadow-xl);
    }
    
    .sidebar.open {
        left: 0;
    }
    
    .diagram-container {
        width: 100%;
    }
    
    .floating-controls {
        bottom: 1rem;
        top: auto;
        flex-direction: row;
        right: 50%;
        transform: translateX(50%);
    }
    
    .legend {
        display: none;
    }
}

@media (max-width: 480px) {
    .controls input[type="text"] {
        min-width: 200px;
    }
    
    .filter-group {
        padding: 0.5rem;
        gap: 0.75rem;
    }
    
    .floating-btn {
        width: 2.5rem;
        height: 2.5rem;
        font-size: 0.75rem;
    }
}

.node {
    stroke: var(--node-border);
    stroke-width: 2;
    cursor: pointer;
    transition: all 0.2s ease;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

.node:hover {
    stroke: var(--node-hover);
    stroke-width: 3;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
}

.node.selected {
    stroke: var(--node-selected);
    stroke-width: 3;
    filter: drop-shadow(0 4px 12px rgba(231, 76, 60, 0.3));
}

.node.search-highlight {
    stroke: var(--primary-color);
    stroke-width: 3;
    filter: drop-shadow(0 0 8px var(--primary-color)) !important;
}

.node.focused-node {
    stroke: #ff6b6b;
    stroke-width: 4;
    filter: drop-shadow(0 0 12px #ff6b6b) !important;
}

.node-text {
    font-size: 12px;
    font-weight: 500;
    text-anchor: middle;
    dominant-baseline: middle;
    fill: var(--text-color);
    pointer-events: none;
}

.node-title {
    font-size: 14px;
    font-weight: 600;
}

.node-type {
    font-size: 10px;
    font-weight: 400;
    opacity: 0.8;
}

.node-details {
    font-size: 9px;
    font-weight: 400;
    opacity: 0.7;
}

.link {
    stroke: var(--link-color);
    stroke-width: 2;
    fill: none;
    marker-end: url(#arrowhead);
    transition: all 0.2s ease;
}

.link:hover {
    stroke-width: 3;
    stroke: var(--link-hover);
}

.link.inheritance {
    stroke-dasharray: none;
    stroke-width: 2.5;
}

.link.conformance {
    stroke-dasharray: 5,5;
}

.link.composition {
    stroke-width: 3;
}

.link.dependency {
    stroke-dasharray: 3,3;
    opacity: 0.7;
}

.type-item {
    padding: 0.75rem;
    margin-bottom: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    background-color: var(--type-item-bg);
}

.type-item:hover {
    background-color: var(--type-item-hover);
    transform: translateX(2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.type-item.selected {
    background-color: var(--type-item-selected);
    color: white;
    border-color: var(--primary-color);
}

.type-item-name {
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.type-item-kind {
    font-size: 0.75rem;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.type-details {
    margin-top: 1.5rem;
    padding: 1rem;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: var(--details-bg);
    max-height: 400px;
    overflow-y: auto;
}

.type-details h4 {
    margin-bottom: 0.75rem;
    font-size: 1.1rem;
    color: var(--primary-color);
}

.type-details h5 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: var(--secondary-color);
}

.type-details ul {
    list-style: none;
    margin-left: 0;
}

.type-details li {
    margin-bottom: 0.375rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    background-color: var(--code-bg);
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 0.8rem;
}

.access-level {
    display: inline-block;
    padding: 0.125rem 0.375rem;
    border-radius: 3px;
    font-size: 0.7rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
}

.access-level.public { background-color: var(--access-public); }
.access-level.internal { background-color: var(--access-internal); }
.access-level.private { background-color: var(--access-private); }

@media (max-width: 768px) {
    .sidebar {
        width: 280px;
    }
    
    .controls {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .filter-group {
        margin-left: 0;
    }
    
    .legend {
        flex-direction: column;
        gap: 0.5rem;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Swift Architecture Diagram</h1>
            <div class="controls">
                <div class="control-group">
                    <button id="reset-zoom">🔄 Reset Zoom</button>
                    <button id="toggle-theme">🌙 Toggle Theme</button>
                </div>
                <div class="control-group">
                    <input type="text" id="search-input" placeholder="Search types...">
                </div>
                <div class="filter-group">
                    <label><input type="checkbox" id="show-properties" checked> Properties</label>
                    <label><input type="checkbox" id="show-methods" checked> Methods</label>
                    <label><input type="checkbox" id="show-initializers" checked> Initializers</label>
                    <label><input type="checkbox" id="show-private"> Private</label>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="sidebar-header">
                    <h3>Type Explorer</h3>
                    <button class="sidebar-toggle" title="Toggle Sidebar">⚇</button>
                </div>
                <div id="type-list"></div>
                <div id="type-details"></div>
            </div>
            
            <div class="diagram-container">
                <div class="diagram-search-bar">
                    <input type="text" id="diagram-search-input" placeholder="Search types across the entire diagram...">
                    <div id="search-results" class="search-results-overlay"></div>
                </div>
                <svg id="diagram"></svg>
                <div class="floating-controls">
                    <button class="floating-btn" id="zoom-in" title="Zoom In">🔍+</button>
                    <button class="floating-btn" id="zoom-out" title="Zoom Out">🔍-</button>
                    <button class="floating-btn" id="fit-to-screen" title="Fit to Screen">⚏</button>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color class-color"></div>
                <span>Class</span>
            </div>
            <div class="legend-item">
                <div class="legend-color struct-color"></div>
                <span>Struct</span>
            </div>
            <div class="legend-item">
                <div class="legend-color protocol-color"></div>
                <span>Protocol</span>
            </div>
            <div class="legend-item">
                <div class="legend-color enum-color"></div>
                <span>Enum</span>
            </div>
            <div class="legend-item">
                <div class="legend-color actor-color"></div>
                <span>Actor</span>
            </div>
        </div>
    </div>
    
    <script>
        const graphData = {
  "nodes" : [
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "column" : 0,
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "kind" : "struct",
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "properties" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "[Double]"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "column" : 1,
          "line" : 34
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "associatedTypes" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "id"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "name"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "Double",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "price"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "description"
          }
        ],
        "typeAliases" : [

        ],
        "initializers" : [
          {
            "isRequired" : false,
            "isFailable" : false,
            "parameters" : [
              {
                "typeName" : "String",
                "typeAttributes" : [

                ],
                "attributes" : [

                ],
                "name" : "id",
                "label" : "id",
                "isVariadic" : false,
                "isInout" : false
              },
              {
                "typeName" : "String",
                "typeAttributes" : [

                ],
                "attributes" : [

                ],
                "name" : "name",
                "label" : "name",
                "isVariadic" : false,
                "isInout" : false
              },
              {
                "typeName" : "Double",
                "typeAttributes" : [

                ],
                "attributes" : [

                ],
                "name" : "price",
                "label" : "price",
                "isVariadic" : false,
                "isInout" : false
              }
            ],
            "accessLevel" : "internal",
            "isAsync" : false,
            "attributes" : [

            ],
            "genericParameters" : [

            ],
            "throws" : false,
            "isConvenience" : false,
            "genericConstraints" : [

            ],
            "isFromExtension" : false
          }
        ],
        "conformedProtocols" : [
          "Hashable",
          "Equatable",
          "CustomStringConvertible"
        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "isVariadic" : false,
                "name" : "lhs",
                "isInout" : false,
                "typeName" : "Product",
                "label" : "lhs",
                "attributes" : [

                ],
                "typeAttributes" : [

                ]
              },
              {
                "name" : "rhs",
                "label" : "rhs",
                "typeName" : "Product",
                "isInout" : false,
                "typeAttributes" : [

                ],
                "isVariadic" : false,
                "attributes" : [

                ]
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : true,
            "isClass" : false,
            "returnType" : "Bool",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "=="
          },
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "name" : "hasher",
                "label" : "into",
                "typeName" : "inout Hasher",
                "isInout" : true,
                "typeAttributes" : [

                ],
                "isVariadic" : false,
                "attributes" : [

                ]
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "hash"
          }
        ],
        "attributes" : [

        ],
        "name" : "Product"
      },
      "relationships" : [
        {
          "from" : "Product",
          "to" : "Product",
          "kind" : "uses",
          "details" : "parameter in: =="
        },
        {
          "from" : "Product",
          "to" : "Hashable",
          "kind" : "implements",
          "details" : "implements protocol"
        },
        {
          "from" : "Product",
          "to" : "CustomStringConvertible",
          "kind" : "conforms"
        },
        {
          "from" : "Product",
          "to" : "inout Hasher",
          "kind" : "uses",
          "details" : "parameter in: hash"
        },
        {
          "from" : "Product",
          "to" : "Equatable",
          "kind" : "conforms"
        },
        {
          "from" : "Product",
          "to" : "Equatable",
          "kind" : "implements",
          "details" : "implements protocol"
        },
        {
          "from" : "Product",
          "to" : "Hashable",
          "kind" : "conforms"
        },
        {
          "from" : "Product",
          "to" : "CustomStringConvertible",
          "kind" : "implements",
          "details" : "implements protocol"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "column" : 0,
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "typeAliases" : [

        ],
        "properties" : [

        ],
        "initializers" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "T"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "line" : 0,
          "file" : "<external>"
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "kind" : "struct",
        "properties" : [

        ],
        "initializers" : [

        ],
        "typeAliases" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "inout Hasher"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "line" : 7,
          "column" : 1
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "kind" : "class",
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "id"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "name"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "displayName"
          }
        ],
        "conformedProtocols" : [

        ],
        "initializers" : [
          {
            "isFailable" : false,
            "throws" : false,
            "attributes" : [

            ],
            "accessLevel" : "internal",
            "isRequired" : false,
            "isConvenience" : false,
            "isAsync" : false,
            "genericParameters" : [

            ],
            "isFromExtension" : false,
            "parameters" : [
              {
                "isVariadic" : false,
                "isInout" : false,
                "attributes" : [

                ],
                "typeAttributes" : [

                ],
                "label" : "id",
                "typeName" : "String",
                "name" : "id"
              },
              {
                "name" : "name",
                "isVariadic" : false,
                "attributes" : [

                ],
                "typeAttributes" : [

                ],
                "isInout" : false,
                "label" : "name",
                "typeName" : "String"
              }
            ],
            "genericConstraints" : [

            ]
          }
        ],
        "typeAliases" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "isNonMutating" : false,
            "accessLevel" : "internal",
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isClass" : false,
            "isStatic" : false,
            "returnType" : "String",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "greet"
          },
          {
            "isFinal" : false,
            "isNonMutating" : false,
            "accessLevel" : "internal",
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isClass" : false,
            "isStatic" : true,
            "returnType" : "BasicUser",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "createDefault"
          }
        ],
        "attributes" : [

        ],
        "name" : "BasicUser"
      },
      "relationships" : [
        {
          "from" : "BasicUser",
          "to" : "BasicUser",
          "details" : "returns from: createDefault",
          "kind" : "uses"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "line" : 239,
          "column" : 1
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "associatedTypes" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "defaultValue" : "\"\"",
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "detailData"
          }
        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "conformedProtocols" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [
          "BaseViewController"
        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "isNonMutating" : false,
            "accessLevel" : "internal",
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isClass" : false,
            "isStatic" : false,
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "loadDetailData"
          }
        ],
        "attributes" : [

        ],
        "name" : "DetailViewController"
      },
      "relationships" : [
        {
          "from" : "DetailViewController",
          "kind" : "inherits",
          "to" : "BaseViewController"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "line" : 92,
          "column" : 5
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "enum",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [
          "Error"
        ],
        "isPhantom" : false,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "CacheError"
      },
      "relationships" : [
        {
          "kind" : "inherits",
          "to" : "Error",
          "from" : "CacheError"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "struct",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "moduleName" : "Swift",
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "Array"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "protocol",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "Swift",
        "attributes" : [

        ],
        "name" : "Codable"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "line" : 65,
          "column" : 1,
          "file" : "test_extension_comprehensive.swift"
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "kind" : "class",
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "id"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "defaultValue" : "[]",
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "[Product]",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "items"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "description"
          }
        ],
        "typeAliases" : [

        ],
        "initializers" : [
          {
            "isConvenience" : false,
            "genericConstraints" : [

            ],
            "isAsync" : false,
            "throws" : false,
            "isFailable" : false,
            "accessLevel" : "internal",
            "attributes" : [

            ],
            "parameters" : [
              {
                "attributes" : [

                ],
                "name" : "id",
                "typeName" : "String",
                "isInout" : false,
                "typeAttributes" : [

                ],
                "isVariadic" : false,
                "label" : "id"
              }
            ],
            "isRequired" : false,
            "genericParameters" : [

            ],
            "isFromExtension" : false
          }
        ],
        "conformedProtocols" : [
          "CustomStringConvertible",
          "Codable"
        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "Order"
      },
      "relationships" : [
        {
          "details" : "implements protocol",
          "to" : "CustomStringConvertible",
          "kind" : "implements",
          "from" : "Order"
        },
        {
          "details" : "implements protocol",
          "to" : "Codable",
          "kind" : "implements",
          "from" : "Order"
        },
        {
          "details" : "property items contains Product",
          "to" : "Product",
          "kind" : "element_type",
          "from" : "Order"
        },
        {
          "to" : "Codable",
          "kind" : "conforms",
          "from" : "Order"
        },
        {
          "to" : "CustomStringConvertible",
          "kind" : "conforms",
          "from" : "Order"
        },
        {
          "details" : "property items uses collection Array",
          "to" : "Array",
          "kind" : "uses",
          "from" : "Order"
        },
        {
          "details" : "property: items",
          "to" : "Product",
          "kind" : "contains",
          "from" : "Order"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "kind" : "class",
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "Error"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "line" : 0,
          "file" : "<external>"
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "protocol",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "Swift",
        "attributes" : [

        ],
        "name" : "CustomStringConvertible"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 5,
          "line" : 97,
          "file" : "test_extension_comprehensive.swift"
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "value"
          }
        ],
        "kind" : "struct",
        "initializers" : [

        ],
        "typeAliases" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "CacheKey"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "line" : 0,
          "file" : "<external>",
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "kind" : "class",
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "properties" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "String: Any"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "column" : 0,
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "kind" : "class",
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "Type"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "line" : 87,
          "column" : 1,
          "file" : "test_extension_comprehensive.swift"
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "defaultValue" : "[:]",
            "accessLevel" : "private",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "[String: Any]",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "cache"
          }
        ],
        "typeAliases" : [

        ],
        "associatedTypes" : [

        ],
        "initializers" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "isNonMutating" : false,
            "accessLevel" : "internal",
            "parameters" : [
              {
                "typeAttributes" : [

                ],
                "name" : "value",
                "isVariadic" : false,
                "typeName" : "T",
                "isInout" : false,
                "attributes" : [

                ]
              },
              {
                "attributes" : [

                ],
                "label" : "for",
                "isVariadic" : false,
                "name" : "key",
                "isInout" : false,
                "typeAttributes" : [

                ],
                "typeName" : "CacheKey"
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isClass" : false,
            "isStatic" : false,
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "store"
          },
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "name" : "type",
                "typeName" : "T.Type",
                "isInout" : false,
                "attributes" : [

                ],
                "isVariadic" : false,
                "typeAttributes" : [

                ]
              },
              {
                "typeAttributes" : [

                ],
                "label" : "for",
                "name" : "key",
                "isInout" : false,
                "attributes" : [

                ],
                "typeName" : "CacheKey",
                "isVariadic" : false
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : true,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "T",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "retrieve"
          }
        ],
        "attributes" : [

        ],
        "name" : "DataManager"
      },
      "relationships" : [
        {
          "kind" : "uses",
          "details" : "property cache uses collection Dictionary",
          "from" : "DataManager",
          "to" : "Dictionary"
        },
        {
          "from" : "DataManager",
          "to" : "T",
          "details" : "parameter in: store",
          "kind" : "uses"
        },
        {
          "from" : "DataManager",
          "to" : "Type",
          "details" : "parameter in: retrieve",
          "kind" : "uses"
        },
        {
          "from" : "DataManager",
          "to" : "CacheKey",
          "details" : "parameter in: retrieve",
          "kind" : "uses"
        },
        {
          "from" : "DataManager",
          "to" : "String: Any",
          "details" : "property: cache",
          "kind" : "contains"
        },
        {
          "from" : "DataManager",
          "to" : "CacheKey",
          "details" : "parameter in: store",
          "kind" : "uses"
        },
        {
          "from" : "DataManager",
          "to" : "T",
          "details" : "returns from: retrieve",
          "kind" : "uses"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "line" : 0,
          "file" : "<external>"
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "struct",
        "conformedProtocols" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "Bool",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "isEmail"
          }
        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "moduleName" : "Swift",
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "String",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "trimmed"
          }
        ],
        "attributes" : [

        ],
        "name" : "String"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "line" : 81,
          "column" : 5,
          "file" : "test_extension_comprehensive.swift"
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "kind" : "enum",
        "initializers" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [
          "CodingKey",
          "String"
        ],
        "isPhantom" : false,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "CodingKeys"
      },
      "relationships" : [
        {
          "from" : "CodingKeys",
          "to" : "String",
          "kind" : "inherits"
        },
        {
          "from" : "CodingKeys",
          "to" : "CodingKey",
          "kind" : "inherits"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "line" : 225,
          "column" : 1
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "defaultValue" : "\"\"",
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "String",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "customProperty"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "Bool",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "isModalPresentation"
          }
        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [
          "UIViewController"
        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "setupUI"
          }
        ],
        "attributes" : [

        ],
        "name" : "BaseViewController"
      },
      "relationships" : [
        {
          "to" : "UIViewController",
          "from" : "BaseViewController",
          "kind" : "inherits"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "protocol",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "Swift",
        "attributes" : [

        ],
        "name" : "Equatable"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "column" : 1,
          "line" : 117
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "kind" : "class",
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "defaultValue" : "[]",
            "accessLevel" : "private",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "[T]",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "items"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "T?",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "max"
          }
        ],
        "typeAliases" : [

        ],
        "conformedProtocols" : [

        ],
        "initializers" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "name" : "item",
                "typeName" : "T",
                "isInout" : false,
                "attributes" : [

                ],
                "typeAttributes" : [

                ],
                "isVariadic" : false
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "Bool",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "contains"
          },
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "name" : "item",
                "typeName" : "T",
                "isInout" : false,
                "attributes" : [

                ],
                "typeAttributes" : [

                ],
                "isVariadic" : false
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "remove"
          },
          {
            "isFinal" : false,
            "isNonMutating" : false,
            "accessLevel" : "internal",
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "[T]",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "sorted"
          }
        ],
        "attributes" : [

        ],
        "name" : "Container"
      },
      "relationships" : [
        {
          "to" : "Array",
          "from" : "Container",
          "details" : "property items uses collection Array",
          "kind" : "uses"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "property items contains T",
          "kind" : "element_type"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "parameter in: contains",
          "kind" : "uses"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "property: items",
          "kind" : "contains"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "parameter in: remove",
          "kind" : "uses"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "property: max",
          "kind" : "contains"
        },
        {
          "to" : "T",
          "from" : "Container",
          "details" : "returns from: sorted",
          "kind" : "uses"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "moduleName" : "Foundation",
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "NSObject"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "line" : 0,
          "column" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "struct",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "Swift",
        "attributes" : [

        ],
        "name" : "Dictionary"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 1,
          "file" : "test_extension_comprehensive.swift",
          "line" : 183
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "associatedTypes" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [
          {
            "isRequired" : false,
            "genericParameters" : [

            ],
            "genericConstraints" : [

            ],
            "attributes" : [

            ],
            "parameters" : [
              {
                "typeName" : "Int",
                "label" : "rows",
                "attributes" : [

                ],
                "name" : "rows",
                "isInout" : false,
                "isVariadic" : false,
                "typeAttributes" : [

                ]
              },
              {
                "isVariadic" : false,
                "name" : "columns",
                "isInout" : false,
                "typeName" : "Int",
                "attributes" : [

                ],
                "label" : "columns",
                "typeAttributes" : [

                ]
              }
            ],
            "isFromExtension" : false,
            "accessLevel" : "internal",
            "isConvenience" : false,
            "throws" : false,
            "isFailable" : false,
            "isAsync" : false
          },
          {
            "isRequired" : false,
            "genericParameters" : [

            ],
            "genericConstraints" : [

            ],
            "attributes" : [

            ],
            "parameters" : [
              {
                "isVariadic" : false,
                "name" : "size",
                "isInout" : false,
                "typeName" : "Int",
                "attributes" : [

                ],
                "label" : "identity",
                "typeAttributes" : [

                ]
              }
            ],
            "isFromExtension" : true,
            "accessLevel" : "internal",
            "isConvenience" : true,
            "throws" : false,
            "isFailable" : false,
            "isAsync" : false
          }
        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "private",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "[[Double]]",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "data"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "Int",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "rows"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "Int",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "columns"
          }
        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [
          {
            "attributes" : [

            ],
            "setterEffects" : {
              "throws" : false,
              "isMutating" : false,
              "isNonMutating" : false,
              "isAsync" : false
            },
            "hasGetter" : true,
            "accessLevel" : "internal",
            "returnType" : "Double",
            "getterEffects" : {
              "throws" : false,
              "isMutating" : false,
              "isAsync" : false,
              "isNonMutating" : false
            },
            "isStatic" : false,
            "parameters" : [
              {
                "isVariadic" : false,
                "name" : "row",
                "isInout" : false,
                "typeName" : "Int",
                "attributes" : [

                ],
                "label" : "row",
                "typeAttributes" : [

                ]
              },
              {
                "isVariadic" : false,
                "name" : "column",
                "isInout" : false,
                "typeName" : "Int",
                "attributes" : [

                ],
                "label" : "column",
                "typeAttributes" : [

                ]
              }
            ],
            "hasSetter" : true,
            "genericConstraints" : [

            ],
            "genericParameters" : [

            ]
          }
        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "Matrix"
      },
      "relationships" : [
        {
          "to" : "[Double]",
          "details" : "property: data",
          "from" : "Matrix",
          "kind" : "contains"
        },
        {
          "to" : "Array",
          "details" : "property data uses collection Array",
          "from" : "Matrix",
          "kind" : "uses"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "<external>",
          "column" : 0,
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "kind" : "class",
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "CodingKey"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "file" : "test_extension_comprehensive.swift",
          "column" : 1,
          "line" : 155
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "struct",
        "conformedProtocols" : [

        ],
        "associatedTypes" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "Double",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "x"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : false,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : true,
            "hasSetter" : false,
            "typeName" : "Double",
            "isFromExtension" : false,
            "hasWillSet" : false,
            "name" : "y"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "Double",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "magnitude"
          },
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "Double",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "angle"
          }
        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "name" : "other",
                "typeAttributes" : [

                ],
                "isVariadic" : false,
                "isInout" : false,
                "typeName" : "Point",
                "label" : "to",
                "attributes" : [

                ]
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "Double",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "distance"
          },
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [
              {
                "typeAttributes" : [

                ],
                "name" : "factor",
                "label" : "by",
                "attributes" : [

                ],
                "typeName" : "Double",
                "isVariadic" : false,
                "isInout" : false
              }
            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "throws" : false,
            "isOptional" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isStatic" : false,
            "isClass" : false,
            "returnType" : "Point",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "scaled"
          }
        ],
        "attributes" : [

        ],
        "name" : "Point"
      },
      "relationships" : [
        {
          "to" : "Point",
          "from" : "Point",
          "kind" : "uses",
          "details" : "returns from: scaled"
        },
        {
          "to" : "Point",
          "from" : "Point",
          "kind" : "uses",
          "details" : "parameter in: distance"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "line" : 214,
          "file" : "test_extension_comprehensive.swift",
          "column" : 1
        },
        "accessLevel" : "internal",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "associatedTypes" : [

        ],
        "kind" : "class",
        "properties" : [
          {
            "attributes" : [

            ],
            "hasDidSet" : false,
            "isUnowned" : false,
            "accessLevel" : "internal",
            "isComputed" : true,
            "isWeak" : false,
            "isLazy" : false,
            "isStatic" : false,
            "hasGetter" : true,
            "isLet" : false,
            "hasSetter" : false,
            "typeName" : "Int",
            "isFromExtension" : true,
            "hasWillSet" : false,
            "name" : "extensionProperty"
          }
        ],
        "typeAliases" : [

        ],
        "conformedProtocols" : [

        ],
        "initializers" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : false,
        "methods" : [
          {
            "isFinal" : false,
            "accessLevel" : "internal",
            "isNonMutating" : false,
            "parameters" : [

            ],
            "genericConstraints" : [

            ],
            "isMutating" : false,
            "genericParameters" : [

            ],
            "isOptional" : false,
            "throws" : false,
            "isAsync" : false,
            "isOverride" : false,
            "isClass" : false,
            "isStatic" : false,
            "returnType" : "String",
            "rethrows" : false,
            "isFromExtension" : true,
            "attributes" : [

            ],
            "name" : "extensionMethod"
          }
        ],
        "attributes" : [

        ],
        "name" : "UnknownClass"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "file" : "<external>",
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "UIKit",
        "attributes" : [

        ],
        "name" : "UIViewController"
      },
      "relationships" : [
        {
          "details" : "framework inheritance chain",
          "kind" : "inherits",
          "from" : "UIViewController",
          "to" : "UIResponder"
        }
      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "line" : 0,
          "file" : "<external>"
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "protocol",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "nestedTypes" : [

        ],
        "subscripts" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "methods" : [

        ],
        "moduleName" : "Swift",
        "attributes" : [

        ],
        "name" : "Hashable"
      },
      "relationships" : [

      ]
    },
    {
      "type" : {
        "location" : {
          "column" : 0,
          "file" : "<external>",
          "line" : 0
        },
        "accessLevel" : "public",
        "genericConstraints" : [

        ],
        "genericParameters" : [

        ],
        "kind" : "class",
        "conformedProtocols" : [

        ],
        "properties" : [

        ],
        "typeAliases" : [

        ],
        "initializers" : [

        ],
        "associatedTypes" : [

        ],
        "protocolRequirements" : [

        ],
        "subscripts" : [

        ],
        "nestedTypes" : [

        ],
        "inheritedTypes" : [

        ],
        "isPhantom" : true,
        "moduleName" : "UIKit",
        "methods" : [

        ],
        "attributes" : [

        ],
        "name" : "UIResponder"
      },
      "relationships" : [
        {
          "details" : "framework inheritance chain",
          "kind" : "inherits",
          "to" : "NSObject",
          "from" : "UIResponder"
        }
      ]
    }
  ]
};
        class SwiftDiagramVisualization {
    constructor(data) {
        this.data = data;
        this.svg = d3.select('#diagram');
        this.container = this.svg.append('g');
        this.selectedNode = null;
        this.simulation = null;
        this.currentTheme = 'light';
        
        this.zoom = d3.zoom()
            .scaleExtent([0.1, 3])
            .on('zoom', this.handleZoom.bind(this));
        
        this.svg.call(this.zoom);
        this.setupEventListeners();
        this.setupDefinitions();
        this.render();
    }
    
    setupEventListeners() {
        d3.select('#reset-zoom').on('click', () => this.resetZoom());
        d3.select('#toggle-theme').on('click', () => this.toggleTheme());
        
        // Original search input (keep for sidebar functionality)
        d3.select('#search-input').on('input', (e) => this.handleSearch(e.target.value));
        
        // New diagram search input
        d3.select('#diagram-search-input').on('input', (e) => this.handleDiagramSearch(e.target.value));
        d3.select('#diagram-search-input').on('focus', () => this.showSearchResults());
        d3.select('#diagram-search-input').on('blur', () => {
            // Delay hiding to allow clicking on results
            setTimeout(() => this.hideSearchResults(), 150);
        });
        
        d3.select('#show-properties').on('change', () => this.render());
        d3.select('#show-methods').on('change', () => this.render());
        d3.select('#show-initializers').on('change', () => this.render());
        d3.select('#show-private').on('change', () => this.render());
        
        // Close search results when clicking outside
        d3.select('body').on('click', (event) => {
            if (!event.target.closest('.diagram-search-bar')) {
                this.hideSearchResults();
            }
        });
        
        // Keyboard shortcuts
        d3.select('body').on('keydown', (event) => {
            if (event.ctrlKey || event.metaKey) {
                switch(event.key) {
                    case '0':
                        event.preventDefault();
                        this.resetZoom();
                        break;
                    case 'f':
                        event.preventDefault();
                        d3.select('#diagram-search-input').node().focus();
                        break;
                }
            }
            
            // ESC to close search results
            if (event.key === 'Escape') {
                this.hideSearchResults();
                d3.select('#diagram-search-input').node().blur();
            }
        });
    }
    
    setupDefinitions() {
        const defs = this.container.append('defs');
        
        // Arrow markers for different relationship types
        const arrowTypes = [
            { id: 'inheritance', color: '#3498db' },
            { id: 'conformance', color: '#9b59b6' },
            { id: 'composition', color: '#e74c3c' },
            { id: 'dependency', color: '#95a5a6' }
        ];
        
        arrowTypes.forEach(type => {
            defs.append('marker')
                .attr('id', `arrowhead-${type.id}`)
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 15)
                .attr('refY', 0)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-5L10,0L0,5')
                .attr('fill', type.color);
        });
    }
    
    handleZoom(event) {
        this.container.attr('transform', event.transform);
    }
    
    resetZoom() {
        this.svg.transition()
            .duration(750)
            .call(this.zoom.transform, d3.zoomIdentity);
    }
    
    toggleTheme() {
        this.currentTheme = this.currentTheme === 'light' ? 'dark' : 'light';
        document.documentElement.className = this.currentTheme + '-theme';
    }
    
    handleSearch(query) {
        const filtered = this.data.nodes.filter(node => 
            node.type.name.toLowerCase().includes(query.toLowerCase()) ||
            node.type.kind.toLowerCase().includes(query.toLowerCase())
        );
        this.updateTypeList(filtered);
        
        // Highlight matching nodes in the diagram
        this.container.selectAll('.node')
            .classed('search-highlight', d => 
                query && filtered.some(f => f.type.name === d.type.name)
            );
    }
    
    handleDiagramSearch(query) {
        if (!query.trim()) {
            this.hideSearchResults();
            // Remove all highlighting
            this.container.selectAll('.node').classed('search-highlight', false);
            return;
        }
        
        const filtered = this.data.nodes.filter(node => 
            node.type.name.toLowerCase().includes(query.toLowerCase()) ||
            node.type.kind.toLowerCase().includes(query.toLowerCase()) ||
            (node.type.properties && node.type.properties.some(prop => 
                prop.name.toLowerCase().includes(query.toLowerCase())
            )) ||
            (node.type.methods && node.type.methods.some(method => 
                method.name.toLowerCase().includes(query.toLowerCase())
            ))
        );
        
        this.displaySearchResults(filtered, query);
        
        // Highlight matching nodes in the diagram
        this.container.selectAll('.node')
            .classed('search-highlight', d => 
                filtered.some(f => f.type.name === d.type.name)
            );
    }
    
    displaySearchResults(results, query) {
        const searchResults = d3.select('#search-results');
        
        if (results.length === 0) {
            searchResults.html('<div class="search-result-item"><div class="search-result-description">No results found</div></div>');
            this.showSearchResults();
            return;
        }
        
        const items = searchResults.selectAll('.search-result-item')
            .data(results.slice(0, 10), d => d.type.name); // Show max 10 results
        
        items.exit().remove();
        
        const itemsEnter = items.enter()
            .append('div')
            .attr('class', 'search-result-item')
            .on('click', (event, d) => this.focusOnNode(d));
        
        const itemsUpdate = itemsEnter.merge(items);
        
        itemsUpdate.html(d => {
            const matchingProps = d.type.properties ? d.type.properties.filter(prop => 
                prop.name.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 3) : [];
            
            const matchingMethods = d.type.methods ? d.type.methods.filter(method => 
                method.name.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 3) : [];
            
            let description = '';
            if (matchingProps.length > 0) {
                description += 'Properties: ' + matchingProps.map(p => p.name).join(', ');
            }
            if (matchingMethods.length > 0) {
                if (description) description += ' • ';
                description += 'Methods: ' + matchingMethods.map(m => m.name).join(', ');
            }
            
            return `
                <div class="search-result-type">\${d.type.name}</div>
                <div class="search-result-kind">\${d.type.kind}</div>
                \${description ? `<div class="search-result-description">\${description}</div>` : ''}
            `;
        });
        
        this.showSearchResults();
    }
    
    showSearchResults() {
        d3.select('#search-results').classed('active', true);
    }
    
    hideSearchResults() {
        d3.select('#search-results').classed('active', false);
    }
    
    focusOnNode(nodeData) {
        // Find the node in the diagram and zoom to it
        const node = this.container.select(`.node[data-name="\${nodeData.type.name}"]`).node();
        if (node) {
            const bbox = node.getBBox();
            const centerX = bbox.x + bbox.width / 2;
            const centerY = bbox.y + bbox.height / 2;
            
            // Calculate transform to center the node
            const svg = d3.select('#diagram');
            const svgRect = svg.node().getBoundingClientRect();
            const scale = 1.5;
            const translateX = svgRect.width / 2 - centerX * scale;
            const translateY = svgRect.height / 2 - centerY * scale;
            
            // Apply zoom transform
            svg.transition()
                .duration(750)
                .call(this.zoom.transform, d3.zoomIdentity.translate(translateX, translateY).scale(scale));
            
            // Temporarily highlight the focused node
            d3.select(node).classed('focused-node', true);
            setTimeout(() => {
                d3.select(node).classed('focused-node', false);
            }, 2000);
        }
        
        this.hideSearchResults();
    }
    
    getNodeColor(kind) {
        const colors = {
            'class': 'var(--node-class)',
            'struct': 'var(--node-struct)',
            'protocol': 'var(--node-protocol)',
            'enum': 'var(--node-enum)',
            'actor': 'var(--node-actor)'
        };
        return colors[kind] || 'var(--node-class)';
    }
    
    getRelationshipColor(kind) {
        const colors = {
            'inherits': '#3498db',
            'conforms': '#9b59b6',
            'contains': '#e74c3c',
            'uses': '#95a5a6'
        };
        return colors[kind] || '#95a5a6';
    }
    
    render() {
        const showProperties = d3.select('#show-properties').property('checked');
        const showMethods = d3.select('#show-methods').property('checked');
        const showInitializers = d3.select('#show-initializers').property('checked');
        const showPrivate = d3.select('#show-private').property('checked');
        
        let filteredNodes = this.data.nodes;
        if (!showPrivate) {
            filteredNodes = filteredNodes.filter(node => node.type.accessLevel !== 'private');
        }
        
        this.renderDiagram(filteredNodes, showProperties, showMethods, showInitializers);
        this.updateTypeList(filteredNodes);
    }
    
    renderDiagram(nodes, showProperties, showMethods, showInitializers) {
        const links = [];
        // Extract relationships from nodes
        nodes.forEach(node => {
            node.relationships.forEach(rel => {
                if (nodes.find(n => n.type.name === rel.to)) {
                    links.push({
                        source: node.type.name,
                        target: rel.to,
                        kind: rel.kind
                    });
                }
            });
        });
        
        // Clear existing content
        this.container.selectAll('.diagram-content').remove();
        const diagramGroup = this.container.append('g').attr('class', 'diagram-content');
        
        // Create simulation with enhanced forces
        this.simulation = d3.forceSimulation(nodes)
            .force('link', d3.forceLink(links).id(d => d.type.name).distance(150).strength(0.1))
            .force('charge', d3.forceManyBody().strength(-800))
            .force('center', d3.forceCenter(400, 300))
            .force('collision', d3.forceCollide().radius(80))
            .force('x', d3.forceX(400).strength(0.05))
            .force('y', d3.forceY(300).strength(0.05));
        
        // Create links
        const link = diagramGroup.append('g')
            .attr('class', 'links')
            .selectAll('line')
            .data(links)
            .join('line')
            .attr('class', d => `link ${d.kind}`)
            .attr('stroke', d => this.getRelationshipColor(d.kind))
            .attr('stroke-width', d => d.kind === 'contains' ? 3 : 2);
        
        // Create nodes
        const node = diagramGroup.append('g')
            .attr('class', 'nodes')
            .selectAll('g')
            .data(nodes)
            .join('g')
            .attr('class', 'node-group')
            .call(d3.drag()
                .on('start', this.handleDragStart.bind(this))
                .on('drag', this.handleDrag.bind(this))
                .on('end', this.handleDragEnd.bind(this)));
        
        // Add rectangles for nodes
        node.append('rect')
            .attr('class', 'node')
            .attr('data-name', d => d.type.name)
            .attr('width', d => this.getNodeWidth(d, showProperties, showMethods, showInitializers))
            .attr('height', d => this.getNodeHeight(d, showProperties, showMethods, showInitializers))
            .attr('rx', 8)
            .attr('ry', 8)
            .attr('fill', d => this.getNodeColor(d.type.kind))
            .on('click', (event, d) => this.selectNode(d));
        
        // Add node content
        this.addNodeContent(node, showProperties, showMethods, showInitializers);
        
        // Update simulation
        this.simulation.on('tick', () => {
            link
                .attr('x1', d => d.source.x + this.getNodeWidth(d.source, showProperties, showMethods, showInitializers) / 2)
                .attr('y1', d => d.source.y + this.getNodeHeight(d.source, showProperties, showMethods, showInitializers) / 2)
                .attr('x2', d => d.target.x + this.getNodeWidth(d.target, showProperties, showMethods, showInitializers) / 2)
                .attr('y2', d => d.target.y + this.getNodeHeight(d.target, showProperties, showMethods, showInitializers) / 2);
            
            node.attr('transform', d => `translate(${d.x},${d.y})`);
        });
    }
    
    getNodeWidth(node, showProperties, showMethods, showInitializers) {
        let width = 180;
        if (showProperties && node.type.properties?.length > 0) width += 20;
        if (showMethods && node.type.methods?.length > 0) width += 20;
        if (showInitializers && node.type.initializers?.length > 0) width += 20;
        return Math.max(width, node.type.name.length * 8 + 40);
    }
    
    getNodeHeight(node, showProperties, showMethods, showInitializers) {
        let height = 60;
        if (showProperties && node.type.properties?.length > 0) {
            height += Math.min(node.type.properties.length * 15, 80);
        }
        if (showMethods && node.type.methods?.length > 0) {
            height += Math.min(node.type.methods.length * 15, 80);
        }
        if (showInitializers && node.type.initializers?.length > 0) {
            height += Math.min(node.type.initializers.length * 15, 80);
        }
        return height;
    }
    
    addNodeContent(nodeSelection, showProperties, showMethods, showInitializers) {
        // Add title
        nodeSelection.append('text')
            .attr('class', 'node-text node-title')
            .attr('x', d => this.getNodeWidth(d, showProperties, showMethods, showInitializers) / 2)
            .attr('y', 20)
            .text(d => d.type.name);
        
        // Add type indicator
        nodeSelection.append('text')
            .attr('class', 'node-text node-type')
            .attr('x', d => this.getNodeWidth(d, showProperties, showMethods, showInitializers) / 2)
            .attr('y', 35)
            .text(d => `<<${d.type.kind}>>`);
        
        // Add details
        nodeSelection.append('text')
            .attr('class', 'node-text node-details')
            .attr('x', d => this.getNodeWidth(d, showProperties, showMethods, showInitializers) / 2)
            .attr('y', 50)
            .text(d => {
                const propCount = d.type.properties?.length || 0;
                const methodCount = d.type.methods?.length || 0;
                const initCount = d.type.initializers?.length || 0;
                return `${propCount}p, ${methodCount}m, ${initCount}i`;
            });
    }
    
    handleDragStart(event, d) {
        if (!event.active) this.simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }
    
    handleDrag(event, d) {
        d.fx = event.x;
        d.fy = event.y;
    }
    
    handleDragEnd(event, d) {
        if (!event.active) this.simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
    
    selectNode(node) {
        this.selectedNode = node;
        d3.selectAll('.node').classed('selected', false);
        d3.selectAll('.node').filter(d => d.type.name === node.type.name).classed('selected', true);
        this.showTypeDetails(node);
    }
    
    updateTypeList(nodes) {
        const typeList = d3.select('#type-list');
        const items = typeList.selectAll('.type-item')
            .data(nodes, d => d.type.name);
        
        const itemsEnter = items.enter()
            .append('div')
            .attr('class', 'type-item');
        
        itemsEnter.append('div')
            .attr('class', 'type-item-name');
        
        itemsEnter.append('div')
            .attr('class', 'type-item-kind');
        
        const itemsUpdate = itemsEnter.merge(items);
        
        itemsUpdate.select('.type-item-name')
            .text(d => d.type.name);
        
        itemsUpdate.select('.type-item-kind')
            .text(d => d.type.kind);
        
        itemsUpdate.on('click', (event, d) => this.selectNode(d));
        
        items.exit().remove();
    }
    
    showTypeDetails(node) {
        const details = d3.select('#type-details');
        details.html('');
        
        const container = details.append('div').attr('class', 'type-details');
        
        container.append('h4').text(node.type.name);
        
        container.append('div')
            .attr('class', `access-level ${node.type.accessLevel}`)
            .text(node.type.accessLevel);
        
        container.append('p').text(`Type: ${node.type.kind}`);
        
        if (node.type.conformedProtocols?.length > 0) {
            container.append('h5').text('Conforms to:');
            const list = container.append('ul');
            node.type.conformedProtocols.forEach(protocol => {
                list.append('li').text(protocol);
            });
        }
        
        if (node.type.initializers?.length > 0) {
            container.append('h5').text('Initializers:');
            const list = container.append('ul');
            node.type.initializers.forEach(init => {
                const params = init.parameters?.map(p => `${p.name}: ${p.typeName}`).join(', ') || '';
                const signature = `init(${params})`;
                list.append('li').text(signature);
            });
        }
        
        if (node.type.properties?.length > 0) {
            container.append('h5').text('Properties:');
            const list = container.append('ul');
            node.type.properties.forEach(prop => {
                const propType = prop.isLet ? 'let' : 'var';
                const propText = `${propType} ${prop.name}: ${prop.typeName}`;
                list.append('li').text(propText);
            });
        }
        
        if (node.type.methods?.length > 0) {
            container.append('h5').text('Methods:');
            const list = container.append('ul');
            node.type.methods.forEach(method => {
                const params = method.parameters?.map(p => `${p.name}: ${p.typeName}`).join(', ') || '';
                const returnType = method.returnType ? ` -> ${method.returnType}` : '';
                const signature = `${method.name}(${params})${returnType}`;
                list.append('li').text(signature);
            });
        }
    }
}

// Enhanced UI functionality
class EnhancedUI {
    constructor() {
        this.setupSidebarToggle();
        this.setupFloatingControls();
        this.setupThemeToggle();
        this.setupKeyboardShortcuts();
        this.setupResponsiveFeatures();
    }
    
    setupSidebarToggle() {
        const sidebarToggle = document.querySelector('.sidebar-toggle');
        const sidebar = document.querySelector('.sidebar');
        
        if (sidebarToggle && sidebar) {
            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('collapsed');
                // Update toggle icon
                sidebarToggle.textContent = sidebar.classList.contains('collapsed') ? '⚆' : '⚇';
            });
        }
        
        // Mobile sidebar toggle
        if (window.innerWidth <= 768) {
            sidebarToggle?.addEventListener('click', () => {
                sidebar?.classList.toggle('open');
            });
        }
    }
    
    setupFloatingControls() {
        const zoomInBtn = document.getElementById('zoom-in');
        const zoomOutBtn = document.getElementById('zoom-out');
        const fitToScreenBtn = document.getElementById('fit-to-screen');
        const resetZoomBtn = document.getElementById('reset-zoom');
        
        // Add click handlers for zoom controls
        zoomInBtn?.addEventListener('click', () => {
            // Trigger zoom in on the diagram
            const event = new CustomEvent('zoom-in');
            document.dispatchEvent(event);
        });
        
        zoomOutBtn?.addEventListener('click', () => {
            const event = new CustomEvent('zoom-out');
            document.dispatchEvent(event);
        });
        
        fitToScreenBtn?.addEventListener('click', () => {
            const event = new CustomEvent('fit-to-screen');
            document.dispatchEvent(event);
        });
        
        resetZoomBtn?.addEventListener('click', () => {
            const event = new CustomEvent('reset-zoom');
            document.dispatchEvent(event);
        });
    }
    
    setupThemeToggle() {
        const themeToggle = document.getElementById('toggle-theme');
        const html = document.documentElement;
        
        // Load saved theme
        const savedTheme = localStorage.getItem('diagram-theme') || 'light';
        html.className = `${savedTheme}-theme`;
        
        themeToggle?.addEventListener('click', () => {
            const currentTheme = html.className.includes('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.className = `${newTheme}-theme`;
            localStorage.setItem('diagram-theme', newTheme);
            
            // Update button text
            themeToggle.innerHTML = newTheme === 'dark' ? '☀️ Light Mode' : '🌙 Dark Mode';
        });
        
        // Set initial button text
        if (themeToggle) {
            themeToggle.innerHTML = savedTheme === 'dark' ? '☀️ Light Mode' : '🌙 Dark Mode';
        }
    }
    
    setupKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + F: Focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                const searchInput = document.getElementById('diagram-search-input');
                searchInput?.focus();
            }
            
            // R: Reset zoom
            if (e.key === 'r' || e.key === 'R') {
                if (!e.target.matches('input, textarea')) {
                    e.preventDefault();
                    document.dispatchEvent(new CustomEvent('reset-zoom'));
                }
            }
            
            // +/=: Zoom in
            if (e.key === '+' || e.key === '=') {
                if (!e.target.matches('input, textarea')) {
                    e.preventDefault();
                    document.dispatchEvent(new CustomEvent('zoom-in'));
                }
            }
            
            // -: Zoom out
            if (e.key === '-') {
                if (!e.target.matches('input, textarea')) {
                    e.preventDefault();
                    document.dispatchEvent(new CustomEvent('zoom-out'));
                }
            }
            
            // Escape: Clear search
            if (e.key === 'Escape') {
                const searchInputs = document.querySelectorAll('#search-input, #diagram-search-input');
                searchInputs.forEach(input => {
                    input.value = '';
                    input.dispatchEvent(new Event('input'));
                });
            }
            
            // T: Toggle theme
            if (e.key === 't' || e.key === 'T') {
                if (!e.target.matches('input, textarea')) {
                    e.preventDefault();
                    document.getElementById('toggle-theme')?.click();
                }
            }
        });
    }
    
    setupResponsiveFeatures() {
        // Handle window resize
        window.addEventListener('resize', () => {
            const sidebar = document.querySelector('.sidebar');
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                sidebar?.classList.remove('collapsed');
            } else {
                sidebar?.classList.remove('open');
            }
        });
        
        // Add touch gesture support for mobile
        if ('ontouchstart' in window) {
            this.setupTouchGestures();
        }
    }
    
    setupTouchGestures() {
        const sidebar = document.querySelector('.sidebar');
        const diagramContainer = document.querySelector('.diagram-container');
        let startX, startY;
        
        diagramContainer?.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        });
        
        diagramContainer?.addEventListener('touchend', (e) => {
            if (!startX || !startY) return;
            
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            const deltaX = endX - startX;
            const deltaY = endY - startY;
            
            // Swipe right to open sidebar (mobile)
            if (deltaX > 50 && Math.abs(deltaY) < 100 && window.innerWidth <= 768) {
                sidebar?.classList.add('open');
            }
            
            // Swipe left to close sidebar (mobile)
            if (deltaX < -50 && Math.abs(deltaY) < 100 && window.innerWidth <= 768) {
                sidebar?.classList.remove('open');
            }
            
            startX = startY = null;
        });
    }
}

// Initialize visualization when DOM is ready  
document.addEventListener('DOMContentLoaded', () => {
    // Initialize enhanced UI features
    new EnhancedUI();
    
    // Initialize the main diagram visualization
    if (typeof graphData !== 'undefined') {
        new SwiftDiagramVisualization(graphData);
    } else {
        console.error('Graph data not found');
    }
});
    </script>
</body>
</html>